{% extends "base.html" %}
{% block content %}
<div class="container ">
    {% for climb in climbs %}
    <div class="row  text-center ">
        <div class="card col-8 offset-md-2">
            <div class="card-body">
                <h5 class="card-title">{{ climb.climb_date }}</h5>
                <h5 class="card-title">{{ climb.climb_time }}</h5>
                <h4 class="card-title">{{ climb.climb_location }}</h4>
                <p class="card-text">
                    {{ climb.climb_description }}
                </p>
                <p>{{ climb.created_by }}</p>

            </div>
        </div>
        {% if session.user != climb.created_by %}
        <a class="btn btn-success" onclick="sendMail()" role="button">Accept Climb</a>
        {% endif %}
        {% if session.user|lower == climb.created_by or session.user|lower == 'admin' %}
        {% if session.user|lower == climb.created_by %}
        <a class="btn btn-success" href="{{ url_for('edit_climb', climb_id=climb._id) }}" role="button">Edit</a>
        {% endif %}
        <a href="#delete_climb{{ climb._id  }}" class="btn btn-danger" data-mdb-toggle="modal" role="button">Delete</a>
        <div class="modal fade " id="delete_climb{{ climb._id }}" tabindex="-1" aria-labelledby="Delete Climb"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content ">
                    <div class="modal-header">
                        <h5 class="modal-title d-flex justify-content-center" id="deleteClimb">Are you sure you want to
                            delete
                            this climbing request?</h5>
                    </div>
                    <div class="modal-body"><i class="fas fa-times"></i></div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" data-mdb-dismiss="modal">Cancel</a>
                        <a href="{{ url_for('delete_climb', climb_id=climb._id) }}" class="btn btn-danger">Delete</a>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% block script %}
{% for climb in climbs %}
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js">
</script>
<script type="text/javascript">
    (function () {
        emailjs.init("user_Pe6VH6LXUub6khTthNcbC");
    })();
</script>
<!-- variables to pass values to send mail-->
<script type="text/javascript">
    var user = "{{ climb.created_by }}"
    var user_email = "{{ climb.email }}"
    var other_user = "{{ username.username }}"
    var other_email = "{{ username.user_email }}"
</script>
<script src="static/js/email.js"></script>
{% endfor %}
{% endblock %}
{% endblock %}