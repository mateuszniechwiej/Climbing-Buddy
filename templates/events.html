{% extends "base.html" %}
{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8 ">
            <form action="{{ url_for('search') }}" method="POST">
                <div class="input-group mt-5 justify-content-center mt-5 pt-5">
                    <div class="form-outline cb-search ">
                        <input type="search" id="query" name="query" class="form-control" minlength="3" />
                    <label class="form-label" for="query"><span>Search in Events</span></label>
                    </div>
                    <button type="submit" class="btn cb-btn--search">
                        <i class="fas fa-search"></i>
                    </button>
                    <a href="{{ url_for('events') }}" class="btn cb-btn--back" >Back to All Events<i class="fas fa-undo"></i></a>            
                </div>
            </form>  
        </div>
        {% if session.user|lower == 'admin' %}
        <div class="col-12 col-md-4 mt-5 text-center mt-5 pt-5">
            <a href="{{ url_for('add_event') }}" class="btn cb-btn--add" type="submit">Add Event<i class="fas fa-plus-square"></i></a>
        </div> 
        {% endif %}     
    </div>
</div>
    {% for event in events %}
    <div class="row text-center justify-content-center cb-events mt-5">
        <div class="card col-11 col-md-5 cb-events-card">            
            <div class="card-body cb-events-body">
                <img src="" class="card-img-top hover-shadow {{ event.event_type }}" alt="..." />
                <h3 class="card-title mt-2">{{ event.event_location }}</h3>
                <h5 class="card-title"><i class="far fa-clock"></i>{{ event.event_date }}</h5>
                <p class="card-text">
                    {{ event.event_description }}
                </p>
                {% if session.user|lower == 'admin' %}
                    <div class="card-footer cb-card--footer pb-2">
                        <a class="btn cb-btn--submit" href="{{ url_for('edit_event', event_id=event._id) }}" role="button">Edit</a>
                        <a class="btn cb-btn--cancel" href="#delete_event{{ event._id }}" role="button" data-mdb-toggle="modal" >Delete</a>
                    </div>
                    <div class="modal fade " id="delete_event{{ event._id }}" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content ">
                                <div class="modal-header">
                                    <h5 class="modal-title d-flex justify-content-center" id="deleteModal">Are you sure you want to delete this event?</h5>
                                </div>
                                <div class="modal-body"><i class="fas fa-times"></i></div>
                                <div class="modal-footer ">
                                    <a href="#" class="btn btn-primary" data-mdb-dismiss="modal">Cancel</a>
                                    <a href="{{ url_for('delete_event', event_id=event._id) }}" class="btn btn-danger pb-5">Delete</a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        <div class="row justify-content-center">
            <div class="col-9 col-lg-4 text-center">
                {{ pagination.links}}
            </div>
        </div>
        
    {% endblock %}